function AdapType(t){if(this.max={},this.min={},this.d={},this.a=-10,this.options,this.kerning=!0,this.ligatures=!0,this.countours=[],this.countArr=0,this.count_fonts=0,this.pageSelected,this.fontScale,this.fontBaseline,this.glyphScale,this.glyphSize,this.glyphBaseline,this.font1="1",this.font2="2",this.fontFileName1,this.fontFileName2,this.limit,this.fontSize,this.textToRender,this.percentage,this.animateonEnter,this.canvas,this.snapCtx,this.width,this.height,this.mode,this.color,this.chosenLetters=0,this.error=[],this.percentagaPerLetter=[],this.animateValue=0,this.loaded=0,this.animating=!1,this.fonts=new Array,this.fonts_info=new Array,this.selected_font=1,!(t=t||{}).empty){if(void 0===t.lineHeight?this.lineHeight=1.2:this.lineHeight=t.lineHeight+.01,void 0===t.color?this.color="black":this.color=t.color,void 0===t.exponential?this.exponential=!0:this.exponential=t.exponential,void 0===t.fonte1?void 0===t.fonts&&error.push("Font 1 not defined!"):this.fontFileName1=t.fonte1,void 0===t.fonte2&&void 0!==t.fonte1?this.mode="deform":void 0===t.fonte2?void 0===t.fonts&&this.error.push("Font 2 not defined!"):this.fontFileName2=t.fonte2,void 0===t.fonts)console.log("Font not defined");else{for(var e=0;e<t.fonts.length;e++)this.fonts.push([]);for(e=0;e<t.fonts.length;e++)this.fonts[e].push(t.fonts[e].font1),this.fonts[e].push(t.fonts[e].font2)}if(void 0===t.strokeWidth?this.strokeWidth=0:this.strokeWidth=t.strokeWidth,void 0===t.stroke?this.stroke="transparent":this.stroke=t.stroke,void 0!==t.mode){if(void 0===t.fonte2&&void 0!==t.fonte1)this.mode="deform";else if("firstLetter"!=t.mode&&"equal"!=t.mode&&"random"!=t.mode&&"firstLetter"!=t.mode&&"lastLetter"!=t.mode&&"middleLetter"!=t.mode&&"chosenLetter"!=t.mode&&"deform"!=t.mode)void 0===t.fonte2?this.mode="deform":this.mode="random";else if(this.mode=t.mode,"chosenLetter"==this.mode)if(void 0!==t.chosenLetters){this.chosenLetters=[];for(var i=0;i<t.chosenLetters.length;i++)t.chosenLetters[i]<=t.textToRender.length&&this.chosenLetters.push(t.chosenLetters[i])}else this.error.push("Need to chose the letter to stretch!")}else this.mode="equal";void 0!==t.start?this.start=t.start:this.start="max",void 0!==t.fontSize?(this.boxHeight=t.fontSize,this.fontSize=t.fontSize):(this.fontSize=100,this.boxHeight=100),void 0!==t.textToRender?this.textToRender=t.textToRender:this.error.push("Text to Render is not defined!"),void 0!==t.canvasWidthMode&&("percentage"==t.canvasWidthMode||"pixels"==t.canvasWidthMode)?this.WidthMode=t.canvasWidthMode:this.WidthMode="percentage",void 0!==t.canvasID?$("#"+t.canvasID).is("canvas")?(this.canvasID=t.canvasID,this.canvas=document.getElementById(t.canvasID),this.snapCtx=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=t.fontSize*this.lineHeight,$("#"+this.canvasID).attr("height",this.height),void 0!==t.canvasWidth?this.canvasWidth=t.canvasWidth:this.canvasWidth=100):this.error.push("The ID of the element, is not a canvas!"):this.error.push("Id of canvas to draw is not defined!"),void 0!==t.animateonEnter?this.animateonEnter=t.animateonEnter:this.animateonEnter=!1,this.limit=1,this.percentage=0}this.options={kerning:this.kerning,features:{liga:this.ligatures,rlig:this.ligatures}}}function linearTween(t,e,i,s){return i*t/s+e}function easeOutCubic(t,e,i,s){return t/=s,i*(--t*t*t+1)+e}function easeInOutCubic(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e}function easeInCubic(t,e,i,s){return i*(t/=s)*t*t+e}AdapType.prototype.changeCanvasWidthDraw=function(t){var e=$("#"+this.canvasID);if("percentage"==this.WidthMode)var i=$(window).width()*t/100;else i=t;this.canvasWidth=t,e.attr("width",i),this.getLimit(),this.interpolate()},AdapType.prototype.changeCanvasWidth=function(t){var e=$("#"+this.canvasID);if("percentage"==this.WidthMode)var i=$(window).width()*t/100;else i=t;e.attr("width",i)},AdapType.prototype.changeCanvasWidthSetup=function(){var t=$("#"+this.canvasID);if("percentage"==this.WidthMode)var e=$(window).width()*this.canvasWidth/100;else e=this.canvasWidth;t.attr("width",e)},AdapType.prototype.getAnimate=function(){return this.animateonEnter},AdapType.prototype.getFontSize=function(){return this.fontSize},AdapType.prototype.setFontSize=function(t){this.fontSize=t},AdapType.prototype.animateFromTo=function(t,e,i){if(void 0===i&&"easeOut"!=i&&"easeIn"!=i&&"easeInOut"!=i)var s="linear";else s=i;if(0==this.animating){this.animating=!0;this.getMinWidth();var n,h=t,a=$(window).width()*this.canvasWidth/100,r=this.canvasWidth,o=this.getMinWidth()*r/a;n="min"==this.start?o:r,e<=o&&(e=o);var d=n,p=this;if(e>n)var c=Math.abs(e-n);else c=Math.abs(n-e);var l=c/h,g=0,f=setInterval(function(){if(n<e)if(e<=d)clearInterval(f),p.animating=!1,p.canvasWidth=e;else{switch(s){case"linear":d=e<=linearTween(g,n,h,l)?e:linearTween(g,n,h,l);break;case"easeIn":d=e<=easeInCubic(g,n,h,l)?e:easeInCubic(g,n,h,l);break;case"easeOut":d=e<=easeOutCubic(g,n,h,l)?e:easeOutCubic(g,n,h,l);break;case"easeInOut":d=e<=easeInOutCubic(g,n,h,l)?e:easeInOutCubic(g,n,h,l);break;default:d=e<=linearTween(g,n,h,l)?e:linearTween(g,n,h,l)}p.changeCanvasWidth(d),p.windowResized()}else if(e<n)if(e>=d)clearInterval(f),p.animating=!1,p.canvasWidth=e;else{switch(s){case"linear":d=e>=linearTween(g,n,-h,l)?e:linearTween(g,n,-h,l);break;case"easeIn":d=e>=easeInCubic(g,n,-h,l)?e:easeInCubic(g,n,-h,l);break;case"easeOut":d=e>=easeOutCubic(g,n,-h,l)?e:easeOutCubic(g,n,-h,l);break;case"easeInOut":d=e>=easeInOutCubic(g,n,-h,l)?e:easeInOutCubic(g,n,-h,l);break;default:d=e>=linearTween(g,n,-h,l)?e:linearTween(g,n,-h,l)}p.changeCanvasWidth(d),p.windowResized()}else p.animating=!1;g++},1e3/30)}},AdapType.prototype.animateBounce=function(t,e,i){var s=i,n=e;if(void 0===s&&"easeOut"!=s&&"easeIn"!=s&&"easeInOut"!=s)i="linear";else i=s;var h=0;if(0==this.animating){this.animating=!0;this.getMinWidth();var a,r=t,o=$(window).width()*this.canvasWidth/100,d=this.canvasWidth,p=this.getMinWidth()*d/o;a="min"==this.start?p:d,n<=p&&(n=p);var c=a,l=this;if(n>a)var g=Math.abs(n-a);else g=Math.abs(a-n);var f=g/r,u=0,v=setInterval(function(){if(a<n)if(0==h)if(n<=c)l.canvasWidth=n,h++,u=0;else{switch(i){case"linear":c=n<=linearTween(u,a,r,f)?n:linearTween(u,a,r,f);break;case"easeIn":c=n<=easeInCubic(u,a,r,f)?n:easeInCubic(u,a,r,f);break;case"easeOut":c=n<=easeOutCubic(u,a,r,f)?n:easeOutCubic(u,a,r,f);break;case"easeInOut":c=n<=easeInOutCubic(u,a,r,f)?n:easeInOutCubic(u,a,r,f);break;default:c=n<=linearTween(u,a,r,f)?n:linearTween(u,a,r,f)}l.changeCanvasWidth(c),l.windowResized()}else if(c<=p)clearInterval(v),l.animating=!1,l.canvasWidth=n;else{switch(i){case"linear":c=p>=linearTween(u,c,-r,f)?p:linearTween(u,c,-r,f);break;case"easeIn":c=p>=easeInCubic(u,c,-r,f)?p:easeInCubic(u,c,-r,f);break;case"easeOut":c=p>=easeOutCubic(u,c,-r,f)?p:easeOutCubic(u,c,-r,f);break;case"easeInOut":c=p>=easeInOutCubic(u,c,-r,f)?p:easeInOutCubic(u,c,-r,f);break;default:c=p>=linearTween(u,c,-r,f)?p:linearTween(u,a,-r,f)}l.changeCanvasWidth(c),l.windowResized()}else if(n<a)if(n>=c)l.canvasWidth=n;else{switch(i){case"linear":c=n>=linearTween(u,a,-r,f)?n:linearTween(u,a,-r,f);break;case"easeIn":c=n>=easeInCubic(u,a,-r,f)?n:easeInCubic(u,a,-r,f);break;case"easeOut":c=n>=easeOutCubic(u,a,-r,f)?n:easeOutCubic(u,a,-r,f);break;case"easeInOut":c=n>=easeInOutCubic(u,a,-r,f)?n:easeInOutCubic(u,a,-r,f);break;default:c=n>=linearTween(u,a,-r,f)?n:linearTween(u,a,-r,f)}l.changeCanvasWidth(c),l.windowResized()}else l.animating=!1;u++},1e3/30)}},AdapType.prototype.animate=function(t,e,i){var s=this.getMinWidth();if("increase"==i?this.animateValue+=t:this.animateValue-=t,"percentage"==this.WidthMode)var n=$(window).width()*this.canvasWidth/100;else n=this.canvasWidth;if(this.animateValue<=0&&"decrease"==i)this.setWithMin(),this.animateValue=0,clearInterval(e);else if(this.animateValue>=n&&"increase"==i)this.animateValue=n-s,clearInterval(e);else{var h=(s+this.animateValue)/n*100;h>this.canvasWidth&&(h=this.canvasWidth,"min"==this.start&&clearInterval(e)),this.changeCanvasWidth(h),this.windowResized()}},AdapType.prototype.getTotalIncrease=function(t,e){var i=this.getMinWidth();if("percentage"==this.WidthMode)var s=$(window).width()*this.canvasWidth/100;else s=this.canvasWidth;return s-i},AdapType.prototype.setWithMin=function(){var t=this.getMinWidth();if("percentage"==this.WidthMode)var e=$(window).width()*this.canvasWidth/100;else e=this.canvasWidth;this.canvasWidth;var i=t*this.canvasWidth/e;t>e&&(i=this.canvasWidth),this.changeCanvasWidth(i),this.windowResized()},AdapType.prototype.setWith=function(t,e){var i=this.getMinWidth()*this.canvasWidth/s;if("percentage"==this.WidthMode)var s=$(window).width()*this.canvasWidth/100;else s=this.canvasWidth;this.canvasWidth;if("pixels"==e)var n=t*this.canvasWidth/s;else n=t;n<i&&(n=i),this.changeCanvasWidth(i),this.windowResized()},AdapType.prototype.getMinWidth=function(){return this.font1.checkWords(this.textToRender,0,this.boxHeight,this.fontSize,this.options)},AdapType.prototype.getMinWidthPx=function(){return this.font1.checkWords(this.textToRender,0,this.boxHeight,this.fontSize,this.options)},AdapType.prototype.getMinWidthPer=function(){var t=$(window).width()*this.canvasWidth/100,e=this.canvasWidth;return this.font1.checkWords(this.textToRender,0,this.boxHeight,this.fontSize,this.options)*e/t},AdapType.prototype.getStart=function(){return this.start},AdapType.prototype.getCanvasWidth=function(){return this.canvasWidth},AdapType.prototype.getCanvasWidthMode=function(){return this.canvasWidthMode},AdapType.prototype.getCanvasID=function(){return this.canvasID},AdapType.prototype.runAdapType=function(){var t=this;if(this.changeCanvasWidthSetup(),0==this.error.length){if(opentype.load(this.fonts[0][0],function(e,i){e?showErrorMessage(e.toString()):t.onFontLoaded(i,1,0)}),opentype.load(this.fonts[0][1],function(e,i){e?showErrorMessage(e.toString()):t.onFontLoaded(i,2,0)}),this.fonts.length>1);}else{for(var e="",i=0;i<this.error.length;i++)e+=i+1+".  "+this.error[i]+"\n";alert(e)}},AdapType.prototype.onFontLoaded=function(t,e,i){if(this.fonts_info.push(t),0==i){1==e?this.font1=t:"deform"!=this.mode&&(this.font2=t),window.font=t;this.width,this.height,this.textToRender;this.countArr=0,this.count_fonts++,(this.count_fonts>=2&&"deform"!=this.mode||"deform"==this.mode)&&(this.getLimit(),"min"!=this.start&&1!=this.animateonEnter||this.setWithMin(),this.interpolate())}},AdapType.prototype.showErrorMessage=function(t){var e=document.getElementById("message");t&&0!==t.trim().length?e.style.display="block":e.style.display="none",e.innerHTML=t},AdapType.prototype.pathCommandToString=function(t){return"<strong>"+t.type+"</strong> "+(void 0!==t.x?"x="+t.x+" y="+t.y+" ":"")+(void 0!==t.x1?"x1="+t.x1+" y1="+t.y1+" ":"")+(void 0!==t.x2?"x2="+t.x2+" y2="+t.y2:"")},AdapType.prototype.contourToString=function(t){return'<pre class="contour">'+t.map(function(t){return'<span class="'+(t.onCurve?"on":"off")+'curve">x='+t.x+" y="+t.y+"</span>"}).join("\n")+"</pre>"},AdapType.prototype.formatUnicode=function(t){return(t=t.toString(16)).length>4?("000000"+t.toUpperCase()).substr(-6):("0000"+t.toUpperCase()).substr(-4)},AdapType.prototype.deform=function(t){t.fill=this.color,t.stroke=this.stroke,t.strokeWidth=this.strokeWidth;for(var e=0;e<t.commands.length;e++){var i=t.commands[e];i.fill=this.color,"Z"!==i.type&&(i.x=i.x*this.percentage),"Q"!==i.type&&"C"!==i.type||(i.x1=i.x1*this.percentage),"C"===i.type&&(i.x2=i.x2*this.percentage)}},AdapType.prototype.doSnap=function(t,e){if(t.fill=this.color,t.stroke=this.stroke,t.strokeWidth=this.strokeWidth,t.commands.length>0)for(var i=0;i<t.commands.length;i++){var s=t.commands[i],n=e.commands[i];s.fill=this.color,s.stroke=this.stroke,s.strokeWidth=this.strokeWidth,s.type===n.type?("Z"!==s.type&&(s.x=s.x+(n.x-s.x)*this.percentage,1==this.exponential?s.y!=n.y&&(void 0===this.a[i]&&(this.max[i]=s.y,this.min[i]=n.y,this.d[i]=(this.max[i]-this.min[i])*Math.exp(this.a*this.percentage)),s.y=this.d[i]*Math.exp(this.a*this.percentage)+this.min[i]):s.y=s.y+(n.y-s.y)*this.percentage),void 0!==n.x1&&void 0!==s.x1&&n.x1!=s.x1&&(s.x1=s.x1+(n.x1-s.x1)*this.percentage),void 0!==n.y1&&void 0!==s.y1&&(n.y1,s.y1),"Q"===s.type||s.type,s.type):console.log("Fonts not Compatible!Check if both fonts have the same quantity of points!")}},AdapType.prototype.doSnaperLetter=function(t,e){var i=this.font1.stringToGlyphs(this.textToRender);if("equal"!=this.mode&&"deform"!=this.mode)for(var s=0;s<t.length;s++){var n=t[s],h=e[s];t[s].fill=this.color,t[s].stroke=this.stroke,t[s].strokeWidth=this.strokeWidth;for(var a=0;a<n.commands.length;a++){var r=n.commands[a],o=h.commands[a];r.type===o.type?(r.x=r.x,r.y=r.y,"Z"!==r.type&&(r.x=r.x+(o.x-r.x)*this.percentage[s],r.y!=o.y&&(void 0===this.a[a]&&(this.max[a]=r.y,this.min[a]=o.y,this.d[a]=(this.max[a]-this.min[a])*Math.exp(this.a*this.percentage[s])),r.y=this.d[a]*Math.exp(this.a*this.percentage[s])+this.min[a])),"Q"!==r.type&&"C"!==r.type||(o.x1!=r.x1&&(r.x1=r.x1+(o.x1-r.x1)*this.percentage[s]),o.y1!=r.y1&&(r.y1=this.d[a]*Math.exp(this.a*this.percentage)+this.min[a])),"C"===r.type&&(r.x2=r.x2+(o.x2-r.x2)*this.percentage[s])):alert("Need to check if font as the same points\nIn glyph "+i[s].name)}}else this.doSnap(t,e)},AdapType.prototype.windowResized=function(){this.snapCtx=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height,this.getLimit(),this.interpolate()},AdapType.prototype.changeFontSizeDraw=function(t){this.fontSize=t,this.getLimit(),this.interpolate()},AdapType.prototype.interpolate=function(){var t,e,i,s;if("equal"!=this.mode&&"deform"!=this.mode){this.percentage=this.getPercentageForLetters(),i=this.font1.getPathLetter(this.textToRender,0,this.boxHeight,this.fontSize,this.options),s=this.font2.getPathLetter(this.textToRender,0,this.boxHeight,this.fontSize,this.options),this.doSnaperLetter(i,s),this.snapCtx.clearRect(0,0,this.canvas.width,this.canvas.height);for(var n=0,h=this.font1.stringToGlyphs(this.textToRender),a=0,r=0,o=0,d=0,p=0,c=0;c<i.length;c++){var l=i[c].getBoundingBox();i.length;if(0==c)n=0;else if(p=this.font1.getKerningValue(h[c-1],h[c]),d=this.convertMeasure(p),a=h[c].getMetrics().leftSideBearing,this.convertMeasure(a),r=h[c-1].getMetrics().rightSideBearing,o=this.convertMeasure(r),"space"==h[c-1].name){var g=h[c-1].advanceWidth;n+=this.convertMeasure(g)}l.x2-l.x1;for(var f=0;f<i[c].commands.length;f++){var u=i[c].commands[f];"Z"!==u.type&&(u.x+=n+d),"Q"!==u.type&&"C"!==u.type||(u.x1+=n+d),"C"===u.type&&(u.x2+=n+d)}n+=l.x2+o,i[c].getBoundingBox(),i[c].draw(this.snapCtx)}}else"equal"==this.mode?(t=this.font1.getPath(this.textToRender,0,this.boxHeight,this.fontSize,this.options),e=this.font2.getPath(this.textToRender,0,this.boxHeight,this.fontSize,this.options),this.percentage=this.getPercentage(),this.doSnap(t,e),this.snapCtx.clearRect(0,0,this.canvas.width,this.canvas.height),t.draw(this.snapCtx)):(t=this.font1.getPath(this.textToRender,0,this.boxHeight,this.fontSize,this.options),this.percentage=this.getPercentage(),this.deform(t),this.snapCtx.clearRect(0,0,this.canvas.width,this.canvas.height),t.draw(this.snapCtx));this.loaded=1},AdapType.prototype.getLoaded=function(){return this.loaded},AdapType.prototype.dividString=function(t){var e=this.canvas.offsetWidth,i=t.split(" "),s=this.getMinWidth(),n=new Array,h=0,a=0;t="";if(s>=e)for(var r=0;r<i.length;r++)a+(h=this.font1.checkWords(i[r],0,this.boxHeight,this.fontSize,this.options))>e?(n.push(t),t=i[r]+" ",a=h):(t+=i[r]+" ",a+=h),r==i.length-1&&n.push(t);return n},AdapType.prototype.getPercentageForLetters=function(){var t=new Array;if("equal"!=this.mode||"deform"!=this.mode)for(var e=0;e<this.limit.length;e++)t[e]=this.limit[e];return t},AdapType.prototype.getPercentage=function(t){if("equal"!=this.mode&&"deform"!=this.mode){var e=new Array;e=this.limit}else if("equal"==this.mode)if(this.limit>=1)e=1;else e=this.limit;else e=this.limit;return e},AdapType.prototype.reRandom=function(){"random"!=this.mode&&(this.mode="random"),this.percentage=0,this.limit=0,this.percentagaPerLetter=[],this.getLimit(),this.interpolate()},AdapType.prototype.changeMode=function(t){"firstLetter"!=t&&"equal"!=t&&"random"!=t&&"firstLetter"!=t&&"lastLetter"!=t&&"middleLetter"!=t&&"chosenLetter"!=t&&"deform"!=t||(this.mode=t,this.percentage=0,this.limit=0,this.percentagaPerLetter=[],this.getLimit(),this.interpolate())},AdapType.prototype.getMode=function(t){return this.mode},AdapType.prototype.changeText=function(t){this.textToRender=t,this.percentage=0,this.limit=0,this.percentagaPerLetter=[],"min"==this.start&&this.setWithMin(),this.getLimit(),this.interpolate()},AdapType.prototype.getText=function(t){return this.textToRender},AdapType.prototype.changeStrokeColor=function(t){this.stroke=t,this.interpolate()},AdapType.prototype.getStrokeColor=function(){return this.stroke},AdapType.prototype.changeStrokeWidth=function(t){this.strokeWidth=t,this.interpolate()},AdapType.prototype.getStrokeWidth=function(){return this.strokeWidth},AdapType.prototype.getExponential=function(){return this.exponential},AdapType.prototype.changeColor=function(t){this.color=t,this.interpolate()},AdapType.prototype.changeExponential=function(t){this.exponential=t,this.interpolate()},AdapType.prototype.getColor=function(t){return this.color},AdapType.prototype.changeLettersSelect=function(t){var e=JSON.parse(t);this.chosenLetters=[];for(var i=0;i<e.length;i++);for(var s=0;s<e.length;s++)e[s]<=this.textToRender.length&&this.chosenLetters.push(e[s])},AdapType.prototype.getLimit=function(){var t=this.font1,e=this.fontSize/10,i=this.canvas.offsetWidth,s=t.checkWords(this.textToRender,0,this.boxHeight,this.fontSize,this.options);if("deform"==this.mode){var n=i-0-s-e,h=i/s;this.limit=h}else{for(var a=this.font2,r=(M=a.checkWords(this.textToRender,0,this.boxHeight,this.fontSize,this.options))-s,o=t.checkWordsLetter(this.textToRender,0,this.boxHeight,this.fontSize,this.options),d=a.checkWordsLetter(this.textToRender,0,this.boxHeight,this.fontSize,this.options),p=this.font1.stringToGlyphs(this.textToRender),c=0;c<o.length;c++)o[c];if("equal"!=this.mode){i-=0;if(this.textToRender.indexOf(" ")>=0)for(var l=0;l<o.length;l++)"space"==p[l].name&&o[l];n=i-s;if(0==this.percentage){var g=[],f=1-o.length/100*1.5;if(n>0){var u=n,v=[];g=[];for(var y=0;y<o.length;y++){if(0==(L=d[y]-o[y])){var m=(W=o[y])/i,x=0;this.percentagaPerLetter.push(m)}else if("random"==this.mode){if(y==o.length-1)var T=u;else if("space"==p[y].name)var T=0;else(T=Math.round(Math.random()*u/o.length*2.5))>d[y]&&(T=d[y]);var W=T+o[y];v.push(W),u-=T;x=this.getLimit_byWidth(W,o[y],L),m=W/i;this.percentagaPerLetter.push(m)}else if("firstLetter"==this.mode){if(0==y)W=u+o[y];else W=o[y];v.push(W);x=this.getLimit_byWidth(W,o[y],L),m=W/i;this.percentagaPerLetter.push(m)}else if("lastLetter"==this.mode){if(y==o.length-1)W=u+o[y];else W=o[y];v.push(W);x=this.getLimit_byWidth(W,o[y],L),m=W/i;this.percentagaPerLetter.push(m)}else if("middleLetter"==this.mode){if(y==parseInt(o.length/2))W=u+o[y];else W=o[y];v.push(W);x=this.getLimit_byWidth(W,o[y],L),m=W/i;this.percentagaPerLetter.push(m)}else if("chosenLetter"==this.mode){var w=u/this.chosenLetters.length;for(W=0,l=0;l<this.chosenLetters.length;l++){if(y+1==this.chosenLetters[l]){W=w+o[y];break}W=o[y]}x=this.getLimit_byWidth(W,o[y],L),m=W/i;this.percentagaPerLetter.push(m)}g.push(x)}}else{var b=i/s*this.fontSize;this.fontSize=b,this.height=b*this.lineHeight,this.boxHeight=b,$("#"+this.canvasID).attr("height",this.height);var M=a.checkWords(this.textToRender,0,this.boxHeight,b,this.options);for(o=t.checkWordsLetter(this.textToRender,0,this.boxHeight,b,this.options),d=a.checkWordsLetter(this.textToRender,0,this.boxHeight,b,this.options),p=this.font1.stringToGlyphs(this.textToRender),y=0;y<o.length;y++){var L;u=i-s;if(0==(L=d[y]-o[y])){x=0;m=(W=o[y])/i,x=0;this.percentagaPerLetter.push(m)}else if("random"==this.mode){f=1-o.length/100*1.5;if(y==o.length-1)T=u;else if("space"==p[y].name)T=0;else(T=Math.round(Math.random()*u*f))>d[y]&&(T=d[y]);u-=T;m=(W=T+o[y])/i;this.percentagaPerLetter.push(m)}else if("firstLetter"==this.mode){if(0==y)W=u+o[y];else W=o[y];m=W/i;this.percentagaPerLetter.push(m)}else if("lastLetter"==this.mode){if(y==o.length-1)W=u+o[y];else W=o[y];m=W/i;this.percentagaPerLetter.push(m)}else if("middleLetter"==this.mode){if(y==parseInt(o.length/2))W=u+o[y];else W=o[y];m=W/i;this.percentagaPerLetter.push(m)}else if("chosenLetter"==this.mode){for(w=u/this.chosenLetters.length,W=0,l=0;l<this.chosenLetters.length;l++){if(y+1==this.chosenLetters[l]){W=w+o[y];break}W=o[y]}m=W/i;this.percentagaPerLetter.push(m)}g.push(0)}}this.limit=g}else{var A=this.getAllGlyphWidth(this.limit,o,d),S=this.canvas.offsetWidth,C=(M=this.getSumGlyphsWithoutMargin(d),this.getSumGlyphsWithoutMargin(A),this.font1.stringToGlyphs(this.textToRender)),k=i,I=0;if(this.textToRender.indexOf(" ")>=0)for(l=0;l<o.length;l++){r=d[l]-o[l];"space"==C[l].name?(k-=o[l],I+=o[l]):this.getWith_byLimit(o[l],this.limit[l],r)}var R=S-I;if(this.textToRender.indexOf(" ")>=0)for(l=0;l<o.length;l++){r=d[l]-o[l];if("space"!=C[l].name){this.percentagaPerLetter[l];var z=this.percentagaPerLetter[l];this.percentagaPerLetter[l]=R*z/k}}var O=this.widthOverload(S,o,d);if(s<S)for(var P=0;P<this.limit.length;P++){r=d[P]-o[P],g=0,W=0,this.getWith_byLimit(o[P],this.limit[P],r);var H=o[P];if("space"!=C[P].name)var G=S*this.percentagaPerLetter[P];else G=H;var B=G-H;O>0?H<=G&&"space"!=C[P].name?O>B?(W=H,O-=B):"space"!=C[P].name?(W=G-O,O=0):W=H:W=H:W=H<G&&"space"!=C[P].name?G:H,g="space"!=C[P].name?this.getLimit_byWidth(W,o[P],r):0,this.limit[P]=g,W}else{for(P=0;P<this.limit.length;P++)g=0,this.limit[P]=g,W=o[P];b=S/s*this.fontSize;this.fontSize=b,this.height=b*this.lineHeight,this.boxHeight=b,$("#"+this.canvasID).attr("height",this.height)}}}else{this.getGlyphsWithoutMarginArraySum(i);var _=Math.abs(s-i);if(M>i&&s<i)h=this.getLimit_byWidth(i,s,r);else if(_>=1){h=0;b=i/s*this.fontSize;this.fontSize=b,this.boxHeight=b,this.height=b*this.lineHeight,$("#"+this.canvasID).attr("height",this.height)}else h=1;this.limit=h}}},AdapType.prototype.getLimit_byWidth=function(t,e,i){return(t-e)/i},AdapType.prototype.getWith_byLimit=function(t,e,i){return i*e+t},AdapType.prototype.getAllGlyphWidth=function(t,e,i){for(var s=t,n=e,h=i,a=new Array,r=0;r<s.length;r++){var o=h[r]-n[r],d=this.getWith_byLimit(e[r],s[r],o);a[r]=d}return a},AdapType.prototype.getSumGlyphsWithMargin=function(t){for(var e=this.font1.stringToGlyphs(this.textToRender),i=t,s=0,n=0,h=0,a=0,r=0,o=0;o<t.length;o++)n=e[o].getMetrics().rightSideBearing,a=this.convertMeasure(n),s+=i[o]+a+r,h=e[o].getMetrics().leftSideBearing,r=this.convertMeasure(h);return s},AdapType.prototype.getSumGlyphsWithoutMargin=function(t){this.font1.stringToGlyphs(this.textToRender);for(var e=t,i=0,s=0;s<t.length;s++)i+=e[s];return i},AdapType.prototype.getSumGlyphsWithMarginArray=function(t){for(var e=this.font1.stringToGlyphs(this.textToRender),i=t,s=new Array,n=0,h=0,a=0,r=0,o=0;o<t.length;o++)n=e[o].getMetrics().rightSideBearing,a=this.convertMeasure(n),s[o]=i[o]+a+r,h=e[o].getMetrics().leftSideBearing,r=this.convertMeasure(h);return s},AdapType.prototype.getGlyphsWithoutMarginArray=function(t){for(var e=this.font1.stringToGlyphs(this.textToRender),i=t,s=new Array,n=0,h=0,a=0,r=0,o=0;o<t.length;o++)n=e[o].getMetrics().rightSideBearing,a=this.convertMeasure(n),h=e[o].getMetrics().leftSideBearing,r=this.convertMeasure(h),s[o]=i[o]-a-r;return s},AdapType.prototype.getGlyphsWithoutMarginArraySum=function(t){for(var e=this.font1.stringToGlyphs(this.textToRender),i=t,s=0,n=0,h=0,a=0;a<e.length;a++)s=e[a].getMetrics().rightSideBearing,h=this.convertMeasure(s),n=e[a].getMetrics().leftSideBearing,i+=-h-this.convertMeasure(n);return i},AdapType.prototype.getGlyphWithMargin=function(t,e){var i=this.font1.stringToGlyphs(this.textToRender),s=parseInt(e),n=i[s].getMetrics().rightSideBearing,h=this.convertMeasure(n),a=i[s].getMetrics().leftSideBearing;return t+h+this.convertMeasure(a)},AdapType.prototype.getGlyphWith_withoutMargin=function(t,e){var i=this.font1.stringToGlyphs(this.textToRender),s=i[e].getMetrics().rightSideBearing,n=this.convertMeasure(s),h=i[e].getMetrics().leftSideBearing;return t-n-this.convertMeasure(h)},AdapType.prototype.convertMeasure=function(t){return t*(1/(this.options.unitsPerEm||1e3)*this.fontSize)},AdapType.prototype.widthOverload=function(t,e,i){for(var s=e,n=this.font1.stringToGlyphs(this.textToRender),h=0,a=0;a<this.limit.length;a++){var r=this.percentagaPerLetter[a],o=s[a];if("space"!=n[a].name)var d=t*r;else d=o;d<=o&&(h+=o-d)}return h};